<!DOCTYPE html>
<html>
<head>
  <title>Channel</title>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
  <script type="text/javascript" charset="utf-8"></script>
  <script>
  document.addEventListener('DOMContentLoaded',()=>{
    console.log("document loaded");
    var socket=io.connect(location.protocol+'//'+document.domain+':'+location.port+'/chat');
    socket.on("connectmsg",(data)=>{
      console.log("socket connected");

    });

    document.querySelector("#joinroombutton").onclick=()=>{
      console.log("button clicked")
      room=document.querySelector("#joinroom").value
      socket.emit("joinroom",{"room":room});
      console.log("joinroom event emitted")
    };

    document.querySelector("#createroombutton").onclick=()=>{
      console.log("button clicked")
      room=document.querySelector("#roomname").value
      socket.emit("createroom",{"room":room});
      console.log("createroom event emitted")
    };

    socket.on('redirect', data=>{
      console.log("window.location not pass")
      window.location.href="/templates/index.html"
      console.log("window.location pass")
    });
    socket.on('roomnotavailable', data=>{
      document.querySelector("#roomnotavailable").innerHTML="data.room is not roomnotavailable";
    })
  });
  </script>

</head>
<body id="body">
  <h1>Hello {{ name }}</h1>
<form id="createroom">
  Create New Room: <input id="roomname" name="name" type="text" placeholder="Enter Room Name">
  <button id="createroombutton" >Click here!</button>
  </form>
  <form id="joinroom">
    Or Join Existing Room:
      <select>
        {% for room in roomlist %}
        <option value="{{ room }}">{{ room }}</option>
        {% endfor %}
    </select>
    <button id="joinroombutton" >Join room</button>
  </form>
  <div id="roomnotavailable">
  </div>

</body>
</html>
